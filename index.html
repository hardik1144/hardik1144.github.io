<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Tax Calculator</title>
    <style>
        /* Additional styling for tooltip icons */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 100%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .info-icon {
            margin-left: 5px;
            font-size: 16px;
            cursor: help;
        }
    </style>
</head>
<body>
    <h1>Tax Calculator</h1>
    <form>
        <div>
            <label for="grossIncome">Gross Annual Income:</label>
            <input type="number" id="grossIncome">
            <span class="tooltip"><span class="info-icon">&#x3F;</span><span class="tooltiptext">Total yearly income before any deductions.</span></span>
            <span id="grossIncomeError" class="error-icon" style="display:none;">!</span>
        </div>
        <div>
            <label for="extraIncome">Extra Income:</label>
            <input type="number" id="extraIncome">
            <span class="tooltip"><span class="info-icon">&#x3F;</span><span class="tooltiptext">Any additional income such as bonuses, freelance work, etc.</span></span>
            <span id="extraIncomeError" class="error-icon" style="display:none;">!</span>
        </div>
        <div>
            <label for="deductions">Deductions:</label>
            <input type="number" id="deductions">
            <span class="tooltip"><span class="info-icon">&#x3F;</span><span class="tooltiptext">Deductible expenses such as retirement savings, health insurance, etc.</span></span>
            <span id="deductionsError" class="error-icon" style="display:none;">!</span>
        </div>
        <div>
            <label for="ageGroup">Age Group:</label>
            <select id="ageGroup">
                <option value="">Select your age group</option>
                <option value="<40">Less than 40</option>
                <option value=">=40 & <60">40 to 59</option>
                <option value=">=60">60 and older</option>
            </select>
            <span class="tooltip"><span class="info-icon">&#x3F;</span><span class="tooltiptext">Select your current age group.</span></span>
            <span id="ageGroupError" class="error-icon" style="display:none;">!</span>
        </div>
        <button type="button" id="calculate">Calculate</button>
    </form>
    <div id="resultModal" class="modal" style="display:none;">
        <!-- Modal content -->
    </div>

    <script>$(function () {
    $('[data-toggle="tooltip"]').tooltip();
});

function calculateTax() {
    let grossIncome = parseFloat($('#grossIncome').val());
    let extraIncome = parseFloat($('#extraIncome').val());
    let deductions = parseFloat($('#deductions').val());
    let ageGroup = $('#age').val();

    let totalIncome = grossIncome + extraIncome - deductions;
    let taxRate = 0;
    let taxDue = 0;

    if (totalIncome > 800000) {
        switch(ageGroup) {
            case 'under40':
                taxRate = 0.30;
                break;
            case 'between40and60':
                taxRate = 0.40;
                break;
            case '60plus':
                taxRate = 0.10;
                break;
            default:
                $('#age').addClass('invalid');
                $('.error-icon').show();
                return;
        }
        taxDue = taxRate * (totalIncome - 800000);
    }

    $('#taxResult').text(`Total Tax Due: â‚¹${taxDue.toLocaleString()}`);
    $('#resultModal').modal('show');
}

$('input, select').on('change', function () {
    $(this).removeClass('invalid');
    $('.error-icon').hide();
});

$('input[type="number"]').on('input', function () {
    if (isNaN(parseFloat($(this).val()))) {
        $(this).addClass('invalid');
        $(this).next('.error-icon').show();
    } else {
        $(this).removeClass('invalid');
        $(this).next('.error-icon').hide();
    }
});
</script>
</body>
</html>
